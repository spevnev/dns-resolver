#include "common.h"
#include "config.h"
#include "resolve.h"

const uint8_t response[]
    = {0xFF, 0xFF, 0x85, 0x80, 0x0, 0x1, 0x0, 0x1, 0x0,  0x0,  0x0,  0x1, 0x1, 0x61, 0x4, 0x74, 0x65, 0x73, 0x74,
       0x3,  0x63, 0x6f, 0x6d, 0x0, 0x0, 0x1, 0x0, 0x1,  0xc0, 0xc,  0x0, 0x1, 0x0,  0x1, 0x0,  0x0,  0x0,  0x0,
       0x0,  0x4,  0x1,  0x2,  0x3, 0x4, 0x0, 0x0, 0x29, 0x4,  0xd0, 0x0, 0x0, 0x0,  0x0, 0x0,  0x0};
size_t response_length = 55;

int main(void) {
    RRVec result = {0};
    bool found = resolve(&result, "a." TEST_DOMAIN, TYPE_A, NAMESERVER_IP, NAMESERVER_PORT, 1000, 0);
    ASSERT(found);

    ASSERT(result.length == 1);
    RR *rr = result.data[0];
    ASSERT(rr->type == TYPE_A);
    ASSERT(rr->data.ip4_addr == get_ip4("1.2.3.4"));

    free_rr_vec(&result);
    return EXIT_SUCCESS;
}
